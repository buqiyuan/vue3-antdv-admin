import{bF as Z,d as _,bG as V,D as ee,aF as te,r as j,bH as oe,w as G,C as Y,v as z,e as x,bI as se,F as v,x as R,a2 as ne,H as b,as as le,$ as ie,bJ as re,am as ae,a6 as W,K as $,G as ue,M as me,L as de,bs as fe,bK as ce,ac as K}from"./index-Clv9zNM3.js";import{S as pe}from"./index-ly56m3IY.js";import{F as ye,a as ge}from"./FullscreenOutlined-DgQLmHrK.js";import{d as he}from"./debounce-BtYDntiA.js";var ve="Expected a function";function O(w,C,a){var p=!0,L=!0;if(typeof w!="function")throw new TypeError(ve);return Z(a)&&(p="leading"in a?!!a.leading:p,L="trailing"in a?!!a.trailing:L),he(w,C,{leading:p,maxWait:C,trailing:L})}const Ce=_({__name:"index",props:V({...ce(),fullscreen:{type:Boolean,default:!1}},{open:{type:Boolean},openModifiers:{}}),emits:V(["update:open","update:fullscreen","ok","cancel"],["update:open"]),setup(w,{emit:C}){const a=w,p=C,L=ee(),M=te(w,"open"),u=j(a.fullscreen),F=j(""),s={top:"n-resize",left:"w-resize",right:"e-resize",bottom:"s-resize",topLeft:"nw-resize",topright:"ne-resize",bottomLeft:"sw-resize",bottomRight:"se-resize",auto:"auto"};let q=!1;const T=oe("modalWrap"),D=()=>{M.value=!1,p("cancel")},N=async()=>{var e;await K();const o=(e=T.value)==null?void 0:e.querySelector(".ant-modal");o&&o.getBoundingClientRect().left<1&&(o.style.left=`${(document.documentElement.clientWidth-o.offsetWidth)/2}px`)},J=async()=>{u.value=!1,N()},A=(o,e)=>{e.style.cursor="move",e.onmousedown=O(t=>{if(u.value)return;document.body.style.userSelect="none";const m=t.clientX-o.getBoundingClientRect().left,d=t.clientY-o.getBoundingClientRect().top,n=l=>{if(u.value)return;let i=l.clientX-m,f=l.clientY-d;const y=document.documentElement.clientWidth-o.offsetWidth,g=document.documentElement.clientHeight-o.offsetHeight;i<=0&&(i=0),f<=0&&(f=0),i>=y&&(i=y),f>=g&&(f=g),o.style.left=`${Math.max(i,0)}px`,o.style.top=`${Math.max(f,0)}px`},r=()=>{document.removeEventListener("mousemove",n),document.removeEventListener("mouseup",r),document.body.style.userSelect="auto"};document.addEventListener("mousemove",n),document.addEventListener("mouseup",r)},20)},Q=async()=>{await K();const o=T.value,e=o.querySelector(".ant-modal-wrap"),t=o.querySelector(".ant-modal");if(e&&t){N();const m=t.querySelector(".ant-modal-header");m&&A(t,m),e.onmousemove=O(d=>{if(u.value)return;const n=d.clientX-t.offsetLeft,r=d.clientY-t.offsetTop,l=d.clientX-t.offsetWidth-t.offsetLeft,i=d.clientY-t.offsetHeight-t.offsetTop,f=n<=0&&n>-8,y=r<5&&r>-8,g=l>=0&&l<8,k=i>-5&&i<8;f&&r>5&&i<-5?e.style.cursor=s.left:y&&n>5&&l<-5?e.style.cursor=s.top:g&&r>5&&i<-5?e.style.cursor=s.right:k&&n>5&&l<-5?e.style.cursor=s.bottom:n>-8&&n<=5&&r<=5&&r>-8?e.style.cursor=s.topLeft:n>-8&&n<=5&&i<=5&&i>-8?e.style.cursor=s.bottomLeft:l<8&&l>=-5&&r<=5&&r>-8?e.style.cursor=s.topright:l<8&&l>=-5&&i<=5&&i>-8?e.style.cursor=s.bottomRight:e.style.cursor=s.auto},20),e.onmousedown=d=>{if(u.value)return;const{top:n,bottom:r,left:l,right:i}=t.getBoundingClientRect(),f=d.clientX-l,y=d.clientY-n,g=t.offsetWidth,k=t.offsetHeight,c=e.style.cursor,I=O(h=>{if(u.value)return;c!==s.auto&&(document.body.style.userSelect="none");const E=`${Math.max(0,h.clientX-f)}px`,S=`${Math.max(0,h.clientY-y)}px`,B=`${Math.min(i,g+l-h.clientX)}px`,P=`${Math.min(window.innerWidth-l,h.clientX-l)}px`,X=`${Math.min(r,k+n-h.clientY)}px`,H=`${Math.min(window.innerHeight-n,h.clientY-n)}px`;c===s.left?(t.style.left=E,t.style.width=B):c===s.top?(t.style.top=S,t.style.height=X):c===s.right?t.style.width=P:c===s.bottom?t.style.height=H:c===s.topLeft?(t.style.left=E,t.style.top=S,t.style.height=X,t.style.width=B):c===s.topright?(t.style.top=S,t.style.width=P,t.style.height=X):c===s.bottomLeft?(t.style.left=E,t.style.width=B,t.style.height=H):c===s.bottomRight&&(t.style.width=P,t.style.height=H),F.value=t.style.width},20),U=()=>{document.removeEventListener("mousemove",I),document.removeEventListener("mouseup",U),document.body.style.userSelect="auto",e.style.cursor=s.auto};document.addEventListener("mousemove",I),document.addEventListener("mouseup",U)}}q=!0};return G(M,async o=>{(o&&Object.is(q,!1)||a.destroyOnClose)&&Q()}),G(()=>L.fullPath,D),(o,e)=>{const t=se;return z(),Y(fe,{to:o.getContainer||"body"},[x(t,null,{default:v(()=>[R("div",{ref:"modalWrap",class:ne(["draggable-modal",{fullscreen:u.value}])},[x(b(le),ie(b(re)(a,["open","onCancel","onOk","onUpdate:open"]),{open:M.value,"onUpdate:open":e[2]||(e[2]=m=>M.value=m),"mask-closable":!1,"get-container":()=>T.value,width:F.value||o.width,onOk:e[3]||(e[3]=m=>p("ok")),onCancel:e[4]||(e[4]=m=>p("cancel"))}),ae({title:v(()=>[W(o.$slots,"title",{},()=>[$(de(o.$attrs.title||"标题"),1)])]),closeIcon:v(()=>[W(o.$slots,"closeIcon",{},()=>[x(b(pe),{class:"ant-modal-operate",onClick:e[1]||(e[1]=ue(()=>{},["stop"]))},{default:v(()=>[u.value?(z(),Y(b(ge),{key:1,onClick:J})):(z(),Y(b(ye),{key:0,onClick:e[0]||(e[0]=m=>u.value=!0)})),x(b(me),{onClick:D})]),_:1})])]),default:v(()=>[W(o.$slots,"default",{},()=>[e[5]||(e[5]=$(" ① 窗口可以拖动；")),e[6]||(e[6]=R("br",null,null,-1)),e[7]||(e[7]=$(" ② 窗口可以通过八个方向改变大小；")),e[8]||(e[8]=R("br",null,null,-1)),e[9]||(e[9]=$(" ③ 窗口可以最小化、最大化、还原、关闭；")),e[10]||(e[10]=R("br",null,null,-1)),e[11]||(e[11]=$(" ④ 限制窗口最小宽度/高度。 "))])]),_:2},[o.$slots.footer?{name:"footer",fn:v(()=>[W(o.$slots,"footer")]),key:"0"}:void 0]),1040,["open","get-container","width"])],2)]),_:3})],8,["to"])}}});export{Ce as _,O as t};
