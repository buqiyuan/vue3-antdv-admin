import{w as b}from"./common-Tev1tLzZ.js";import{aD as _,aZ as D,r as c,e as d,a_ as m,aY as M}from"./index-Clv9zNM3.js";import{d as x}from"./debounce-BtYDntiA.js";import{T as y}from"./index-D0onqgqk.js";async function j(e){return _({url:"/dict/data",method:"GET",params:e})}const V=D("dict",()=>{const e=c(new Map),t=c(new Map),a=c(new Map),r=n=>{const u=(Array.isArray(n)?n:[n]).map(async o=>{if(e.value.has(o)&&!a.value.has(o))return e.value.get(o);e.value.set(o,[]),a.value.set(o,!0);const i=await j({type:o}).finally(()=>a.value.delete(o));return e.value.set(o,i),t.value.set(o,new Map(i.map(p=>[p.value,p.label]))),i});return Promise.all(u)},l=new Proxy({},{get(n,s){if(!s.startsWith("__v_"))return e.value.has(s)||a.value.has(s)||r(s),e.value.get(s)}}),P=(n,s)=>{var u;return l[n],((u=t.value.get(n))==null?void 0:u.get(s))||""},S=new Proxy({},{get(n,s){return a.value.get(s)||!1}});return{dictData:l,dictPending:S,fetchDict:r,showDictLabel:P}});function g(e){return typeof e=="function"||Object.prototype.toString.call(e)==="[object Object]"&&!M(e)}const z=["王路飞","王大蛇","李白","刺客伍六七"],{fetchDict:w,dictPending:h,showDictLabel:f}=V(),v=async(e="")=>{const[t]=await w("sell_status");return b(100,t.filter(a=>a.label.includes(e)))},C=e=>e===1?[{label:"西装",value:1},{label:"领带",value:0}]:e===0?[{label:"裙子",value:1},{label:"包包",value:0}]:[],N=Array.from({length:30}).map((e,t)=>{const a=~~(Math.random()*2);return{id:t+1,date:new Date().toLocaleString(),name:z[~~(Math.random()*4)],clothes:~~(Math.random()*2),price:~~(Math.random()*1e3),gender:a,img:"https://zos.alipayobjects.com/rmsportal/jkjgkEfvpUPVyRjUImniVslZfWPnJuuZ.png",status:~~(Math.random()*2),nested:{prop:`嵌套属性 ${t+1}`}}}),O=[{title:"姓名",dataIndex:"name",sorter:!0,width:300,resizable:!0,formItemProps:{defaultValue:"李白",required:!0}},{title:"性别",dataIndex:"gender",width:120,resizable:!0,formItemProps:{component:"Select",componentProps:({formInstance:e,formModel:t})=>({request:async()=>{const[a]=await w("gender");return a},onChange(){e==null||e.updateSchema({field:"clothes",componentProps:{options:C(t.gender)}}),t.clothes=""}})},customRender:({record:e})=>{let t;return d(m,{spinning:h.sell_status,size:"small"},g(t=f("gender",e.gender))?t:{default:()=>[t]})}},{title:"衣服",dataIndex:"clothes",formItemProps:{component:"Select",componentProps:({tableInstance:e})=>({onChange(){e==null||e.reload()}})}},{title:"价格",dataIndex:"price",formItemProps:{component:"InputNumber"},customRender:({record:e})=>`${e.price}元`},{title:"嵌套属性",dataIndex:["nested","prop"]},{title:"状态",dataIndex:"status",formItemProps:{component:"Select",componentProps:({formInstance:e,schema:t})=>({showSearch:!0,filterOption:!1,request:()=>v(),onSearch:x(async a=>{t.value.loading=!0;const r={field:"status",componentProps:{options:[]}};e==null||e.updateSchema([r]);const l=await v(a).finally(()=>t.value.loading=!1);r.componentProps.options=l,e==null||e.updateSchema([r])},500),onChange(a){}})},customRender:({record:e})=>{let t;return d(m,{spinning:h.sell_status,size:"small"},{default:()=>[d(y,{color:e.status==1?"red":"default"},g(t=f("sell_status",e.status))?t:{default:()=>[t]})]})}}];export{O as c,v as f,C as g,N as t};
