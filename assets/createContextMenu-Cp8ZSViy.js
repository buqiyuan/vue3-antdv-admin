import{d as g,r as w,c as L,e as s,H as k,N as E,aY as M,ef as j,cL as D}from"./index-Clv9zNM3.js";import{D as O}from"./index-C6XAppnf.js";import{M as b}from"./index-BJ4r8mM4.js";import{b as N}from"./is-fQYYZi7x.js";function P(e){return typeof e=="function"||Object.prototype.toString.call(e)==="[object Object]"&&!M(e)}const S={width:{type:Number,default:156},customEvent:{type:Object,default:null},styles:{type:Object},showIcon:{type:Boolean,default:!0},axis:{type:Object,default(){return{x:0,y:0}}},items:{type:Array,default(){return[]}}},x=e=>{const{item:o}=e;return s("span",{style:"display: inline-block; width: 100%; ",class:"px-4",onClick:e.handler.bind(null,o)},[e.showIcon&&o.icon&&s(j,{class:"mr-2",type:o.icon},null),s("span",null,[o.label])])},_=g({name:"ContextMenu",props:S,setup(e,{expose:o}){const y=w(!0),i=L(()=>{const{axis:l,items:t,styles:n,width:r}=e,{x:c,y:d}=l||{x:0,y:0},v=(t||[]).length*40,p=r,h=document.body,C=h.clientWidth<c+p?c-p:c,I=h.clientHeight<d+v?d-v:d;return{position:"absolute",width:`${r}px`,left:`${C+1}px`,top:`${I+1}px`,...n}}),a=()=>{y.value=!1};function u(l,t){const{handler:n,disabled:r}=l;r||(t==null||t.stopPropagation(),t==null||t.preventDefault(),n==null||n(),a())}function f(l){return l.filter(n=>!n.hidden).map(n=>{const{disabled:r,label:c,children:d,divider:v=!1}=n,p={item:n,handler:u,showIcon:e.showIcon};return!d||d.length===0?s(E,null,[s(b.Item,{disabled:r,key:c},{default:()=>[s(x,p,null)]}),v?s(b.Divider,{key:`d-${c}`},null):null]):s(b.SubMenu,{key:c,disabled:r},{title:()=>s(x,p,null),default:()=>f(d)})})}return o({close:a}),()=>{const{items:l}=e;return s(O,{open:y.value},{default:()=>s("div",{style:k(i)},null),overlay:()=>{let t;return s(b,{inlineIndent:12,mode:"vertical"},P(t=f(l))?t:{default:()=>[t]})}})}}}),m={domList:[],resolve:()=>{}},V=function(e){const{event:o}=e||{};if(o&&(o==null||o.preventDefault()),!!N)return new Promise(y=>{const i=document.body,a=document.createElement("div"),u={getPopupContainer:()=>a};e.styles&&(u.styles=e.styles),e.items&&(u.items=e.items),e.event&&(u.customEvent=o,u.axis={x:o.clientX,y:o.clientY});const f=s(_,u);D(f,a);const l=function(){m.resolve("")};m.domList.push(a);const t=function(){m.domList.forEach(n=>{try{n&&i.removeChild(n)}catch(r){console.error(r)}}),i.removeEventListener("click",l),i.removeEventListener("scroll",l)};m.resolve=function(n){var r,c;(c=(r=f.component)==null?void 0:r.exposed)==null||c.close(),t(),y(n)},t(),i.appendChild(a),i.addEventListener("click",l),i.addEventListener("scroll",l)})},W=function(){m&&(m.resolve(""),m.domList=[])};export{V as c,W as d};
