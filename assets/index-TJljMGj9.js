import{f as v}from"./dateUtil-C_wTM_e-.js";import{T as g}from"./index-D0onqgqk.js";import{e as s,K as w,d as C,r as p,eo as b,w as T,o as S,h as O,C as U,v as B,F as N,H as R,at as h}from"./index-Clv9zNM3.js";import{u as K}from"./dynamic-table-ewKYMhCK.js";import"./ApiSelect.vue_vue_type_script_setup_true_lang-DvgRuKxQ.js";import"./dayjs.min-BYaCBWoX.js";import{_ as A}from"./index-CYmqXHpm.js";import"./index-C6XAppnf.js";import"./index-BJ4r8mM4.js";import"./_baseUniq-CsQ8HEXR.js";import"./_arrayIncludesWith-DbV0gfeD.js";import"./collapseMotion-BCa41I5P.js";import"./move-DRIeMv9s.js";import"./RightOutlined-CtKcSETS.js";import"./VerticalRightOutlined-DF3cgokL.js";import"./cloneDeep-s5SpPfgx.js";import"./schema-form.vue_vue_type_script_setup_true_lang-uF5z2XZj.js";import"./is-fQYYZi7x.js";import"./isNumber-s4abpS_O.js";import"./index-CsLYSjjd.js";import"./useFlexGapSupport-FJ5YreuO.js";import"./hasIn-DoY5MSeO.js";import"./debounce-BtYDntiA.js";import"./QuestionCircleOutlined-B99GTLc_.js";import"./_castArrayLikeObject-BIyyQ4IM.js";import"./index-Binr3P75.js";import"./DownOutlined-DxS2-6Ij.js";import"./index-jwD5cS8J.js";import"./pick-DtFW9KKp.js";import"./FullscreenOutlined-DgQLmHrK.js";import"./index-ly56m3IY.js";import"./LeftOutlined-DkJ_dKcN.js";import"./zh_CN-CAyhejr6.js";import"./index-DXPG-Hl7.js";import"./useMergedState-CVClCPu2.js";import"./index-D-la6T6i.js";import"./EnterOutlined-Bw7wTOJA.js";import"./CheckOutlined-C_x0bhih.js";import"./CopyOutlined-DN6DmnBM.js";import"./index-6_t5xb7Y.js";import"./index-C2Yf5-vJ.js";import"./useRefs-CCU70ahe.js";import"./index-BPPLYRCV.js";import"./isMobile-BbN7I0i_.js";const D=[{title:"会话编号",dataIndex:"tokenId",ellipsis:!0,hideInSearch:!0},{title:"用户名",dataIndex:"username",customRender:({record:t})=>s("div",null,[s("span",{class:"pr-4px"},[t.username]),t.isCurrent&&s(g,{color:"processing"},{default:()=>[w("我")]})])},{title:"部门名称",dataIndex:"deptName"},{title:"登录IP",dataIndex:"ip",width:140},{title:"登录地点",dataIndex:"address"},{title:"浏览器",dataIndex:"browser"},{title:"操作系统",dataIndex:"os"},{title:"登录时间",dataIndex:"time",width:180,customRender:({record:t})=>v(t.time)}],Te=C({name:"SystemMonitorOnline",__name:"index",setup(t){let l=[];const r=p(!0),m=p([]),d=p(!1),c=b(),[f,I]=K({size:"small"}),k=[...D,{title:"操作",width:80,dataIndex:"ACTION",actions:({record:e})=>[{label:"下线",auth:"system:online:kick",disabled:e.disable,popConfirm:{title:"确定下线该用户吗?",onConfirm:()=>x(e)}}]}],x=async e=>{await h.systemOnline.onlineKick({tokenId:e.tokenId}),I.reload()},_=(...e)=>{[...e]},y=e=>{const i=Object.keys(e);if(!i.some(n=>!!e[n])){o();return}m.value=l.filter(n=>i.every(a=>!e[a]||n[a].includes(e[a])))},o=async()=>{d.value=!0,l=await h.systemOnline.onlineList().finally(()=>d.value=!1),m.value=l},u=()=>{r.value&&o()};return T(r,e=>{e&&o()}),S(()=>{o(),c.emitter.on("onlineUser",u)}),O(()=>{c.emitter.off("onlineUser",u)}),(e,i)=>{const n=A;return B(),U(R(f),{"row-key":"tokenId","header-title":"在线用户","title-tooltip":"这是真实操作，请不要随意将其他用户踢下线。","data-source":m.value,columns:k,loading:d.value,onChange:_,onSearch:y,onReload:o},{toolbar:N(()=>[s(n,{checked:r.value,"onUpdate:checked":i[0]||(i[0]=a=>r.value=a),"checked-children":"开启实时更新","un-checked-children":"关闭实时更新"},null,8,["checked"])]),_:1},8,["data-source","loading"])}}});export{Te as default};
