import{f as m}from"./dateUtil-C_wTM_e-.js";import{e as o,ar as C,ep as N,aY as k,d as O,aF as V,r as l,c as B,w as M,q as v,v as h,F as f,J as T,x as w,H as I,as as j,N as q,O as _,at as F}from"./index-Clv9zNM3.js";import{T as i}from"./index-D0onqgqk.js";import{S as J}from"./index-ly56m3IY.js";import{P as D}from"./PlusOutlined-8cnECNsV.js";import{_ as E}from"./index-6_t5xb7Y.js";function G(t){return typeof t=="function"||Object.prototype.toString.call(t)==="[object Object]"&&!k(t)}const g=t=>/^https?:\/\//.test(t)?t:N+t,X=[{title:"头像",width:80,dataIndex:"avatar",hideInSearch:!0,customRender:({record:t})=>o(C,{src:g(t.avatar)},null)},{title:"用户名",width:120,dataIndex:"username"},{title:"呢称",width:120,hideInSearch:!0,dataIndex:"nickname"},{title:"所在部门",dataIndex:"dept",hideInSearch:!0,width:180,customRender:({record:t})=>o(i,null,{default:()=>{var a;return[(a=t.dept)==null?void 0:a.name]}})},{title:"所属角色",dataIndex:"roleNames",hideInSearch:!0,width:220,customRender:({record:t})=>{let a;return o(J,null,G(a=t.roles.map(n=>o(i,{color:"success",key:n.id},{default:()=>[n.name]})))?a:{default:()=>[a]})}},{title:"邮箱",width:120,dataIndex:"email"},{title:"手机",width:120,dataIndex:"phone"},{title:"备注",width:120,dataIndex:"remark"},{title:"状态",dataIndex:"status",width:100,hideInSearch:!0,formItemProps:{component:"Select",componentProps:{options:[{label:"启用",value:1},{label:"禁用",value:0}]}},customRender:({record:t})=>{const a=~~t.status===1;return o(i,{color:a?"success":"red"},{default:()=>[a?"启用":"禁用"]})}},{title:"创建时间",dataIndex:"createdAt",width:120,hideInSearch:!0,customRender:({record:t})=>m(t.createdAt)},{title:"修改时间",dataIndex:"updatedAt",width:120,hideInSearch:!0,customRender:({record:t})=>m(t.createdAt)}],L={key:0},Y=["src"],Z=O({name:"AvatarUpload",inheritAttrs:!1,__name:"AvatarUpload",props:{value:{},valueModifiers:{}},emits:["update:value"],setup(t){const a=V(t,"value"),n=l([]),u=l(!1),c=l(""),d=l(""),p=B(()=>g(a.value)),x=M(a,e=>{e&&!n.value.length&&(n.value=[{uid:`vc-upload-${Date.now()}-1`,name:e.split("/").at(-1),status:"done",url:p.value}],x())}),y=e=>{const r=e.type==="image/jpeg"||e.type==="image/png";r||_.error("You can only upload JPG/PNG file!");const s=e.size/1024/1024<2;return s||_.error("Image must smaller than 2MB!"),r&&s},b=async e=>{const{filename:r}=await F.toolsUpload.uploadUpload({file:e});a.value=r},A=async e=>{await b(e.file)},S=({file:e})=>{e.status="done",n.value=[e]},U=e=>{a.value="",n.value=[]},P=()=>{u.value=!1,d.value=""},R=async e=>{!e.url&&!e.preview&&(e.preview=p.value),c.value=e.url||e.preview,u.value=!0,d.value=e.name||e.url.substring(e.url.lastIndexOf("/")+1)};return(e,r)=>{const s=j;return h(),v(q,null,[o(I(E),{"file-list":n.value,name:"avatar","list-type":"picture-card",class:"min-h-[110px]","custom-request":A,onBeforeUpload:y,onChange:S,onRemove:U,onPreview:R},{default:f(()=>[n.value.length<1?(h(),v("div",L,[o(I(D)),r[0]||(r[0]=w("div",{style:{"margin-top":"8px"}},"Upload",-1))])):T("",!0)]),_:1},8,["file-list"]),o(s,{open:u.value,title:d.value,footer:null,onCancel:P},{default:f(()=>[w("img",{alt:"example",style:{width:"100%"},src:c.value},null,8,Y)]),_:1},8,["open","title"])],64)}}});export{Z as _,X as b};
