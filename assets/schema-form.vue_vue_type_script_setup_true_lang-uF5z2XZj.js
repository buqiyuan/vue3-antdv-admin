import{ds as Ee,dt as We,du as Ke,aQ as Le,cK as B,d as le,a5 as xe,c as S,e as V,H as t,cH as Ne,dv as $,cb as te,N as re,ad as we,dw as qe,dx as Ue,cP as ze,aY as he,$ as U,w as fe,y as Ge,J as z,z as He,C as D,v as T,dd as Z,F as G,X as ne,q as be,a6 as H,x as ve,L as ce,dy as Ye,am as je,T as Se,a_ as Je,cu as Xe,ac as Ze,n as _e,dz as Qe,B as et,K as ye,Y as tt,cZ as nt,r as Be,aC as ge,dA as J,bi as st,de as Fe,dB as ot,dC as at,cO as rt}from"./index-Clv9zNM3.js";import{c as ct,s as lt,d as it,e as ut,f as dt}from"./ApiSelect.vue_vue_type_script_setup_true_lang-DvgRuKxQ.js";import{i as X}from"./is-fQYYZi7x.js";import{d as ke}from"./dayjs.min-BYaCBWoX.js";import{i as Ae}from"./isNumber-s4abpS_O.js";import{c as $e}from"./cloneDeep-s5SpPfgx.js";import{b as ft,C as mt,A as pt,F as Pe}from"./index-CsLYSjjd.js";import{d as ht}from"./debounce-BtYDntiA.js";import{D as yt}from"./index-Binr3P75.js";import{D as gt}from"./DownOutlined-DxS2-6Ij.js";import{d as Ce}from"./index-jwD5cS8J.js";import{d as Ie}from"./dateUtil-C_wTM_e-.js";import{b as bt}from"./_baseUniq-CsQ8HEXR.js";import{p as vt}from"./pick-DtFW9KKp.js";var St="[object Boolean]";function ae(a){return a===!0||a===!1||Ee(a)&&We(a)==St}function Te(a){return a==null}function wt(a){return a===null}function At(a){return a===void 0}function Pt(a,y){return a&&a.length?bt(a,ft(y)):[]}function Me(a,y){return a==null?!0:Ke(a,y)}const De=Le(mt),Rt=Le(pt);function xt(a,y="default",u){if(!a||!Reflect.has(a,y))return null;if(!B(a[y]))return console.error(`${y} is not a function!`),null;const v=a[y];return v?v(u):null}const Bt={maxWidth:{type:String,default:"600px"},showIndex:{type:Boolean},color:{type:String,default:"#ffffff"},fontSize:{type:String,default:"14px"},placement:{type:String,default:"right"},text:{type:[Array,String]}},Ft=le({name:"BasicHelp",components:{Tooltip:xe},props:Bt,setup(a,{slots:y}){const u=S(()=>({color:a.color,fontSize:a.fontSize})),v=S(()=>({maxWidth:a.maxWidth}));function g(){const i=a.text;return $(i)?V("p",null,[i]):te(i)?i.map((k,h)=>V("p",{key:k},[V(re,null,[a.showIndex?`${h+1}. `:"",k])])):null}return()=>V(xe,{overlayClassName:"basic-help__wrap",title:V("div",{style:t(u)},[g()]),autoAdjustOverflow:!0,overlayStyle:t(v),placement:a.placement},{default:()=>[V("span",{class:"basic-help"},[xt(y)||V(Ne,null,null)])]})}});function Oe(a,y=""){const{t:u}=we();if(a.includes("Input")||a.includes("Complete"))return`${u("common.inputText")}${y}`;const v=["Select","Cascader","Checkbox","CheckboxGroup","Switch","TreeSelect"];return a.includes("Picker")||v.includes(a)?`${u("common.chooseText")}${y}`:""}const kt=["DatePicker","MonthPicker","WeekPicker","TimePicker"];function Ct(){return[...kt,"RangePicker"]}function It(a,y){return a&&["Input","InputPassword","InputSearch","InputTextArea"].includes(a)&&y&&Ae(y)?`${y}`:y}const Tt=Ct(),Ve=Symbol("schema-form");async function Mt(a){qe(Ve,a)}function Re(a={}){return Ue(Ve,a)}function Ot(a,y){return S(()=>{const u=t(a),{labelCol:v={},wrapperCol:g={}}=u.formItemProps||{},{labelWidth:i,disabledLabelWidth:k}=u,{labelWidth:h,labelCol:w,wrapperCol:O,layout:M}=t(y);if(!h&&!i&&!w||k)return v.style={textAlign:"left"},{labelCol:v,wrapperCol:g};let l=i||h;const R={...w,...v},F={...O,...g};return l&&(l=Ae(l)?`${l}px`:l),{labelCol:{style:{width:l},...R},wrapperCol:{style:{width:M==="vertical"?"100%":`calc(100% - ${l})`},...F}}})}const Lt={formModel:{type:Object,default:()=>({})},schema:{type:Object,default:()=>({})},tableInstance:{type:Object},tableRowKey:{type:[String,Number]}},jt={class:"mr-[6px]"},_t={class:"ml-[6px]"},$t=le({name:"SchemaFormItem",__name:"schema-form-item",props:Lt,emits:["update:formModel"],setup(a,{emit:y}){const u=a,v=y,g=Re(),{formPropsRef:i,setItemRef:k,updateSchema:h,getSchemaByField:w,appendSchemaByField:O}=g,{t:M}=we(),{schema:l}=ze(u),R=Ot(l,i),F=S(()=>te(l.value.field)?l.value.field:l.value.field.split(".")),A=S({get(){return F.value.reduce((s,o)=>s==null?void 0:s[o],u.formModel)},set(s){const o=l.value.field.split("."),d=o.pop(),e=o.reduce((n,r)=>n[r]??(n[r]={}),u.formModel);e[d]=s,v("update:formModel",u.formModel)}}),E=S(()=>{const{component:s,componentProps:o}=l.value;if(!B(o)&&(o!=null&&o.vModelKey))return o.vModelKey;const d=$(s)&&["Switch","Checkbox"].includes(s),e=s==="Upload";return{true:"value",[`${d}`]:"checked",[`${e}`]:"file-list"}.true}),m=S(()=>{const{formModel:s,schema:o,tableInstance:d}=u,{mergeDynamicData:e}=t(i);return{field:o.field,formInstance:g,tableInstance:d,tableRowKey:u.tableRowKey,formModel:u.tableRowKey?s[u.tableRowKey]:s,values:{...e,...s},schema:S(()=>u.schema)}}),b=S(()=>{const{vShow:s,vIf:o,isAdvanced:d=!1}=t(l),{showAdvancedButton:e}=t(i),n=e&&ae(d)?d:!0;let r=!0,p=!0;return ae(s)&&(r=s),ae(o)&&(p=o),B(s)&&(r=s(t(m))),B(o)&&(p=o(t(m))),r=r&&n,{isShow:r,isIfShow:p}}),N=S(()=>{const{disabled:s}=t(i),{dynamicDisabled:o}=u.schema,{disabled:d=!1}=t(L);let e=!!s||d;return ae(o)&&(e=o),B(o)&&(e=o(t(m))),e}),P=(s,o=t(m))=>{if($(s))return V(re,null,[s]);if(he(s))return s;if(B(s))return P(s(o));if(s&&X(s)){const d=Object.keys(s);return d.some(e=>e.startsWith("_")||["setup","render"].includes(e))?s:d.reduce((e,n)=>(e[n]=(...r)=>P(s[n],...r),e),{})}return s},C=S(()=>{const s=u.schema.component;return $(s)?ct[s]??P(s):P(s)}),Y=S(()=>{const s=u.schema.componentSlots??{};return $(s)||he(s)?{default:(...o)=>P(s,o)}:P(s)}),W=S(()=>{const s=u.schema.label;return B(s)?s(t(m)):s}),L=S(()=>{const{schema:s}=u;let{componentProps:o={},component:d}=s;return B(o)&&(o=o(t(m))??{}),d!=="RangePicker"&&$(d)&&(o.placeholder??(o.placeholder=Oe(d,W.value))),s.component==="Divider"&&(o=Object.assign({type:"horizontal"},o,{orientation:"left",plain:!0})),he(C.value)&&Object.assign(o,C.value.props),o}),Q=S(()=>{const s=L.value;return Object.keys(s).reduce((o,d)=>{if(/^on([A-Z])/.test(d)){const e=d.replace(/^on([A-Z])/,"$1").toLocaleLowerCase();o[e]=s[d]}return o},{})}),ie=S(()=>{const{helpMessage:s,helpComponentProps:o,subLabel:d}=u.schema,e=d?V("span",null,[W.value," ",V("span",{class:"text-secondary"},[d])]):P(W.value),n=B(s)?s(t(m)):s;return!n||Array.isArray(n)&&n.length===0?e:V("span",null,[e,V(Ft,U({placement:"top",class:"mx-1",text:n},o),null)])});function me(s,o,d){["DatePicker","MonthPicker","WeekPicker","TimePicker"].includes(o)?s.type=d?"string":"object":["RangePicker","Upload","CheckboxGroup","TimePicker"].includes(o)?s.type="array":["InputNumber"].includes(o)&&(s.type="number")}const pe=S(()=>{var oe;const{rules:s=[],component:o,rulesMessageJoinLabel:d,dynamicRules:e,required:n}=u.schema;if(B(e))return e(t(m));let r=$e(s);const{rulesMessageJoinLabel:p}=t(i),f=Reflect.has(t(i),"rulesMessageJoinLabel")?d:p,c=$(o)?`${Oe(o,W.value)}${f?W.value:""}`:void 0;function x(q,K){const de=q.message||c;return K===void 0||wt(K)||Array.isArray(K)&&K.length===0||typeof K=="string"&&K.trim()===""||typeof K=="object"&&Reflect.has(K,"checked")&&Reflect.has(K,"halfChecked")&&Array.isArray(K.checked)&&Array.isArray(K.halfChecked)&&K.checked.length===0&&K.halfChecked.length===0?Promise.reject(de):Promise.resolve()}const I=B(n)?n(t(m)):n;(!r||r.length===0)&&I&&(r=[{required:I,validator:x}]);const j=r.findIndex(q=>Reflect.has(q,"required")&&!Reflect.has(q,"validator"));if(j!==-1){const q=r[j];if(o&&$(o)){Reflect.has(q,"type")||(q.type=o==="InputNumber"?"number":"string"),q.message=q.message||c,(o.includes("Input")||o.includes("Textarea"))&&(q.whitespace=!0);const K=(oe=t(L))==null?void 0:oe.valueFormat;me(q,o,K)}}const _=r.findIndex(q=>q.max);return _!==-1&&!r[_].validator&&(r[_].message=r[_].message||M("component.form.maxTip",[r[_].max])),r}),ue=async s=>{try{const o=Object.assign(l.value,{loading:!0,componentProps:{...t(L),options:[]}});h(o);const d=await s(t(m)),{component:e}=t(l),n=o.componentProps;["Select","RadioGroup","CheckboxGroup"].includes(e)?n.options=d:["TreeSelect","Tree"].includes(e)&&(n.treeData=d),o.componentProps&&(o.componentProps.requestResult=d),o.loading=!1,h(o)}finally{await Ze(),l.value.loading=!1}},se=()=>{const s=L.value.request;if(s)if(B(s))ue(s);else{const{watchFields:o=[],options:d={},wait:e=0,callback:n}=s,r=o.map(p=>()=>u.formModel[p]);fe(r,ht(()=>{ue(n)},e),{...d})}};return fe(b,(s,o)=>{!Xe(s,o)&&s.isIfShow&&s.isShow&&(w(u.schema.field)||O(u.schema),se())},{immediate:!0}),(s,o)=>b.value.isIfShow?Ge((T(),D(t(De),Z(U({key:0},t(l).colProps)),{default:G(()=>[t(l).component==="Divider"?(T(),D(t(yt),Z(U({key:0},Object.assign(L.value))),{default:G(()=>[(T(),D(ne(ie.value)))]),_:1},16)):(T(),D(t(Pe).Item,U({key:1},{...t(l).formItemProps,...t(R)},{label:ie.value,name:F.value,rules:pe.value}),{default:G(()=>[t(l).beforeSlot?(T(),be(re,{key:0},[t($)(t(l).beforeSlot)?H(s.$slots,t(l).beforeSlot,Z(U({key:0},m.value)),()=>[ve("span",jt,ce(t(l).beforeSlot),1)],!0):z("",!0),t(B)(t(l).beforeSlot)?(T(),D(ne(t(l).beforeSlot(m.value)),{key:1})):z("",!0)],64)):z("",!0),t(l).slot?H(s.$slots,t(l).slot,Z(U({key:1},m.value)),void 0,!0):C.value?(T(),D(ne(C.value),U({key:2,ref:t(k)(t(l).field)},L.value,{[E.value]:A.value,["onUpdate:"+E.value]:o[0]||(o[0]=d=>A.value=d),"allow-clear":!0,disabled:N.value,loading:t(l).loading},Ye(Q.value)),je({_:2},[Object.is(t(l).loading,!0)?{name:"notFoundContent",fn:G(()=>[V(t(Je),{size:"small"})]),key:"0"}:void 0,Se(Y.value,(d,e)=>({name:e,fn:G(n=>[(T(),D(ne((d==null?void 0:d({...m.value,slotData:n}))??d),{key:e}))])}))]),1040,["disabled","loading"])):z("",!0),t(l).afterSlot?(T(),be(re,{key:3},[t($)(t(l).afterSlot)?H(s.$slots,t(l).afterSlot,Z(U({key:0},m.value)),()=>[ve("span",_t,ce(t(l).afterSlot),1)],!0):z("",!0),t(B)(t(l).afterSlot)?(T(),D(ne(t(l).afterSlot(m.value)),{key:1})):z("",!0)],64)):z("",!0)]),_:3},16,["label","name","rules"]))]),_:3},16)),[[He,b.value.isShow]]):z("",!0)}}),Dt=_e($t,[["__scopeId","data-v-245f1f33"]]),Vt=le({__name:"index",props:{expand:{type:Boolean}},setup(a){Qe(v=>({"4cf09dcc":u.value}));const y=a,u=S(()=>`${y.expand?0:.5}turn`);return(v,g)=>(T(),D(t(gt),{class:"collapse-icon"}))}}),Et=_e(Vt,[["__scopeId","data-v-af0a3cde"]]),Wt=le({name:"FormAction",inheritAttrs:!1,__name:"form-action",props:{showActionButtonGroup:{type:Boolean,default:!0},showResetButton:{type:Boolean,default:!0},showSubmitButton:{type:Boolean,default:!0},showAdvancedButton:{type:Boolean,default:!0},resetButtonOptions:{type:Object,default:()=>({})},submitButtonOptions:{type:Object,default:()=>({})},actionColOptions:{type:Object,default:()=>({})},actionSpan:{type:Number,default:6},isAdvanced:Boolean,hideAdvanceBtn:Boolean},emits:["toggle-advanced"],setup(a,{emit:y}){const u=y,v=a,{t:g}=we(),{resetFields:i,submit:k}=Re(),h=S(()=>{const{showAdvancedButton:R,actionSpan:F,actionColOptions:A}=v,E=24-F,m=R?{span:E<6?24:E}:{};return{style:{textAlign:"right"},span:R?6:4,...m,...A}}),w=S(()=>Object.assign({text:g("common.resetText")},v.resetButtonOptions)),O=S(()=>Object.assign({text:g("common.queryText")},v.submitButtonOptions));function M(){u("toggle-advanced",v.isAdvanced)}const l=async R=>{await k(R).catch(()=>{})};return(R,F)=>{const A=et("a-button");return a.showActionButtonGroup?(T(),D(t(De),Z(U({key:0},h.value)),{default:G(()=>[ve("div",{style:tt([{width:"100%"},{textAlign:h.value.style.textAlign}])},[V(t(Pe).Item,null,{default:G(()=>[H(R.$slots,"resetBefore"),a.showResetButton?(T(),D(A,U({key:0,type:"default",class:"mr-2"},w.value,{onClick:t(i)}),{default:G(()=>[ye(ce(w.value.text),1)]),_:1},16,["onClick"])):z("",!0),H(R.$slots,"submitBefore"),a.showSubmitButton?(T(),D(A,U({key:1,type:"primary",class:"mr-2"},O.value,{onClick:F[0]||(F[0]=E=>l(E))}),{default:G(()=>[ye(ce(O.value.text),1)]),_:1},16)):z("",!0),H(R.$slots,"advanceBefore"),a.showAdvancedButton&&!a.hideAdvanceBtn?(T(),D(A,{key:2,type:"link",size:"small",onClick:M},{default:G(()=>[ye(ce(a.isAdvanced?t(g)("component.form.putAway"):t(g)("component.form.unfold"))+" ",1),V(t(Et),{class:"ml-1",expand:!a.isAdvanced},null,8,["expand"])]),_:1})):z("",!0),H(R.$slots,"advanceAfter")]),_:3})],4)]),_:3},16)):z("",!0)}}}),Kt=a=>{const y=nt(),u=Be({...a,schemas:$e(a.schemas)}),v=ge({...a.initialValues}),g=ge({...a.initialValues}),i=Be(),k={...a.initialValues},h=new Map,w=new Map,O=ge({isAdvanced:!0,hideAdvanceBtn:!1,isLoad:!1,actionSpan:6}),M=S(()=>({...y,...u.value})),l=S(()=>{const{baseRowStyle:F={},rowProps:A}=t(M);return{style:F,...A}}),R=S(()=>({...M.value,...O}));return fe(()=>u.value.schemas,()=>{var F;(F=u.value.schemas)==null||F.forEach(A=>{!w.has(A.field)&&B(A.componentProps)&&w.set(A.field,A.componentProps),At(A.defaultValue)||J(g,A.field,A.defaultValue)})}),{formModel:v,defaultFormValues:g,schemaFormRef:i,formPropsRef:u,cacheFormModel:k,compRefMap:h,getFormProps:M,advanceState:O,getRowConfig:l,getFormActionBindProps:R,originComponentPropsFnMap:w}},Nt=a=>{const{formState:y,emit:u}=a,{compRefMap:v,formModel:g,formPropsRef:i,cacheFormModel:k,schemaFormRef:h,getFormProps:w,defaultFormValues:O,originComponentPropsFnMap:M}=y,l=e=>n=>{n&&v.set(e,n)};function R(){return t(h)?se(st(t(g))):{}}function F(e){var n;return(n=t(i).schemas)==null?void 0:n.some(r=>r.field===e&&$(r.component)?Tt.includes(r.component):!1)}async function A(e){const n=t(i).schemas,r=n.map(f=>f.field).filter(Boolean);Object.assign(k,e);const p=[];Object.entries(e).forEach(([f,c])=>{const x=n.find(j=>j.field===f),I=Reflect.has(e,f);if($(x==null?void 0:x.component)&&(c=It(x==null?void 0:x.component,c)),I&&r.includes(f)){if(F(f))if(Array.isArray(c)){const j=[];for(const _ of c)j.push(_?ke(_):null);J(g,f,j)}else{const{componentProps:j}=x||{};let _=j;B(j)&&(_=_({formPropsRef:i,formModel:g})),J(g,f,c?_!=null&&_.valueFormat?c:ke(c):null)}else J(g,f,c);p.push(f)}}),await W(p).catch(f=>{})}async function E(e){let n=[];X(e)&&n.push(e),te(e)&&(n=[...e]),t(i).schemas=n}async function m(e,n,r=!1){const p=[...t(i).schemas],f=p.findIndex(c=>c.field===n);if(!n||f===-1||r){r?p.unshift(e):p.push(e),i.value.schemas=p;return}f!==-1&&p.splice(f+1,0,e),i.value.schemas=p,C(i.value.schemas)}async function b(e){const n=[...t(i).schemas];if(!e)return;let r=$(e)?[e]:e;$(e)&&(r=[e]);for(const p of r)if($(p)){const f=n.findIndex(c=>c.field===p);f!==-1&&(Me(g,p),n.splice(f,1))}i.value.schemas=n}function N(e){return t(i).schemas.find(n=>e===n.field)}const P=e=>{let n=[];if(X(e)&&n.push(e),te(e)&&(n=[...e]),!n.every(c=>c.component==="Divider"||Reflect.has(c,"field")&&c.field)){console.error("All children of the form Schema array that need to be updated must contain the `field` field");return}const p=[],f=[];t(i).schemas.forEach(c=>{const x=n.find(I=>c.field===I.field);if(x){const I=x.componentProps,j=Ce(c,x);if(M.has(c.field)){const _=M.get(c.field);j.componentProps=oe=>({..._(oe),...B(I)?I(oe):I})}f.push(j),p.push(j)}else p.push(c)}),C(f),i.value.schemas=Pt(p,"field")};function C(e){let n=[];X(e)&&n.push(e),te(e)&&(n=[...e]);const r={},p=R();n.forEach(f=>{f.component!="Divider"&&Reflect.has(f,"field")&&f.field&&!Te(f.defaultValue)&&(!(f.field in p)||Te(p[f.field]))&&(r[f.field]=f.defaultValue)}),A(r)}async function Y(){const{resetFunc:e,submitOnReset:n}=t(w);B(e)&&await e(),Object.keys(g).forEach(r=>{J(g,r,O[r])}),u("reset",g),n&&d(),setTimeout(Q)}async function W(e){var n;return(n=h.value)==null?void 0:n.validateFields(e)}async function L(e){return await h.value.validate(e)}async function Q(e){var n;await((n=h.value)==null?void 0:n.clearValidate(e))}async function ie(e,n){var r;await((r=h.value)==null?void 0:r.scrollToField(e,n))}const me=(e,n)=>{var p;J(g,e,n),J(k,e,n);const{validateTrigger:r}=t(w);(!r||r==="change")&&((p=h.value)==null||p.validateFields([e]))},pe=e=>Me(g,e),ue=e=>{const{schemas:n}=i.value;i.value=Ce(t(i)||{},e),i.value.schemas=n!=null&&n.length?n:cloneDeep(e.schemas)};function se(e){var r,p;if(!X(e))return{};const n={};for(let[f,c]of Object.entries(e)){if(!f||te(c)&&c.length===0||B(c))continue;const{transformDateFunc:x}=t(w);X(c)&&(c=x==null?void 0:x(c)),te(c)&&((r=c[0])!=null&&r.format)&&((p=c[1])!=null&&p.format)&&(c=c.map(j=>x==null?void 0:x(j))),$(c)&&(c=c.trim());const I=N(f);if(B(I==null?void 0:I.transform)&&(c=I==null?void 0:I.transform(c),X(c))){Object.assign(n,c),Reflect.deleteProperty(n,f);continue}J(n,f,c)}return s(n)}function s(e){const n=t(w).fieldMapToTime;if(!n||!Array.isArray(n))return e;for(const[r,[p,f],c="YYYY-MM-DD"]of n){if(!r||!p||!f||!e[r])continue;const[x,I]=e[r];if(!x||!I){Reflect.deleteProperty(e,r);continue}e[p]=Ie(x).format(c),e[f]=Ie(I).format(c),Reflect.deleteProperty(e,r)}return e}const o=e=>{const{autoSubmitOnEnter:n}=t(i);if(n&&e.key==="Enter"&&e.target&&e.target instanceof HTMLElement){const r=e.target;r&&r.tagName&&r.tagName.toUpperCase()=="INPUT"&&d(e)}};async function d(e){var p;(p=e==null?void 0:e.preventDefault)==null||p.call(e);const{submitFunc:n}=t(w);if(n&&B(n)){await n();return}if(t(h))try{const f=await L(),c=se(f);return u("submit",c),c}catch(f){return Promise.reject(f)}}return{submit:d,setItemRef:l,clearValidate:Q,validate:L,validateFields:W,getFieldsValue:R,updateSchema:P,resetSchema:E,getSchemaByField:N,appendSchemaByField:m,removeSchemaByField:b,resetFields:Y,setFieldsValue:A,scrollToField:ie,setDefaultValue:C,setFormModel:me,delFormModel:pe,setSchemaFormProps:ue,handleFormValues:se,handleEnterPress:o}};let qt,Ut,zt;function Gt(){return{screenRef:S(()=>t(qt)),widthRef:Ut,screenEnum:lt,realWidthRef:zt}}const ee=24,Ht=a=>{const{formState:y,emit:u}=a,v=Re(),{realWidthRef:g,screenEnum:i,screenRef:k}=Gt(),{advanceState:h,getFormProps:w,formPropsRef:O,formModel:M,defaultFormValues:l}=y,R=S(()=>{if(!h.isAdvanced)return 0;const m=t(w).emptySpan||0;if(Ae(m))return m;if(X(m)){const{span:b=0}=m,N=t(k);return m[N.toLowerCase()]||b||0}return 0});fe([()=>O.value.schemas,()=>h.isAdvanced,()=>t(g)],()=>{const{showAdvancedButton:m}=t(w);m&&A()},{immediate:!0});function F(m,b=0,N=!1){const P=t(g),C=parseInt(m.md)||parseInt(m.xs)||parseInt(m.sm)||m.span||ee,Y=parseInt(m.lg)||C,W=parseInt(m.xl)||Y,L=parseInt(m.xxl)||W;return P<=i.LG?b+=C:P<i.XL?b+=Y:P<i.XXL?b+=W:b+=L,N?(h.hideAdvanceBtn=!1,b<=ee*2?(h.hideAdvanceBtn=!0,h.isAdvanced=!0):b>ee*2&&b<=ee*(t(w).autoAdvancedLine||3)?h.hideAdvanceBtn=!1:h.isLoad||(h.isLoad=!0,h.isAdvanced=!h.isAdvanced),{isAdvanced:h.isAdvanced,itemColSum:b}):b>ee*(t(w).alwaysShowLines||1)?{isAdvanced:h.isAdvanced,itemColSum:b}:{isAdvanced:!0,itemColSum:b}}function A(){let m=0,b=0;const{baseColProps:N={}}=t(w);for(const P of t(O).schemas){const{vShow:C,colProps:Y}=P;let W=!0;if(ae(C)&&(W=C),B(C)&&(W=C({schema:S(()=>t(formSchemasRef).schemas.find(L=>L.field===P.field)),formModel:M,field:P.field,formInstance:v,values:{...t(l),...M}})),W&&(Y||N)){const{itemColSum:L,isAdvanced:Q}=F({...N,...Y},m);m=L||0,Q&&(b=m),P.isAdvanced=Q}}h.actionSpan=b%ee+t(R),F(t(w).actionColOptions||{span:ee},m,!0),u("advanced-change")}function E(){h.isAdvanced=!h.isAdvanced}return{handleToggleAdvanced:E}},un=le({name:"SchemaForm",__name:"schema-form",props:ut,emits:it,setup(a,{expose:y,emit:u}){const v=a,g=u,i=Kt(v),{formModel:k,getRowConfig:h,schemaFormRef:w,getFormProps:O,getFormActionBindProps:M,formPropsRef:l}=i,R=Nt({formState:i,emit:g}),{handleEnterPress:F,setDefaultValue:A}=R,E={props:v,emit:g,...i,...R};Mt(E);const{handleToggleAdvanced:m}=Ht({formState:i,emit:g});return g("register",E),y(E),A(l.value.schemas),(b,N)=>(T(),D(t(Pe),U({ref_key:"schemaFormRef",ref:w},t(vt)(t(O),t(dt)),{model:t(k),onKeypress:ot(t(F),["enter"])}),{default:G(()=>[V(t(Rt),Z(Fe(t(h))),{default:G(()=>[H(b.$slots,"formHeader"),H(b.$slots,"default",{},()=>[(T(!0),be(re,null,Se(t(l).schemas,P=>(T(),D(ne(at(Dt,{},b.$slots)),{key:P.field,"form-model":t(k),"onUpdate:formModel":N[0]||(N[0]=C=>rt(k)?k.value=C:null),schema:P,"table-instance":b.tableInstance},null,40,["form-model","schema","table-instance"]))),128)),b.showActionButtonGroup?(T(),D(Wt,U({key:0},t(M),{onToggleAdvanced:t(m)}),je({_:2},[Se(["resetBefore","submitBefore","advanceBefore","advanceAfter"],P=>({name:P,fn:G(C=>[H(b.$slots,P,Z(Fe(C||{})))])}))]),1040,["onToggleAdvanced"])):z("",!0)]),H(b.$slots,"formFooter")]),_:3},16)]),_:3},16,["model","onKeypress"]))}});export{Dt as S,un as _,Te as a,Ft as b,Rt as c,De as d,ae as i,Lt as s};
